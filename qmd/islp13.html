<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Multiple Testing</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<link href="../https://assets.qiufei.site/personal/profile.jpg" rel="icon" type="image/jpeg">
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-8ea72dc5fed832574809a9c94082fbbb.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-681fbf911679f9b3dbf9743eb275ba49.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-7e49aeac8059a213a463aa1a739e8272.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://qiufei.github.io"> 
<span class="menu-text">È¶ñÈ°µ</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://qiufei.github.io/web-slide-r"> 
<span class="menu-text">RËØæ‰ª∂</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://qiufei.github.io/web-slide-marketing"> 
<span class="menu-text">Ëê•ÈîÄËØæ‰ª∂</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Multiple Testing</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction-statistical-learning-and-hypothesis-testing" class="level2">
<h2 class="anchored" data-anchor-id="introduction-statistical-learning-and-hypothesis-testing">Introduction: Statistical Learning and Hypothesis Testing</h2>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[5,5]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://www.statlearning.com/s/The-Elements-of-Statistical-Learning-2nd-Edition-Springer.jpeg" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p>Statistical learning is a set of tools for modeling and understanding complex datasets. It is a vital area with applications in many fields. Hypothesis testing, a core concept in statistical inference, allows us to use data to answer ‚Äúyes-or-no‚Äù questions, moving beyond simply estimating values or making predictions.</p>
</div>
</div>
</div>
</section>
<section id="the-challenge-of-big-data" class="level2">
<h2 class="anchored" data-anchor-id="the-challenge-of-big-data">The Challenge of Big Data</h2>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[5,5]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<p><img src="https://www.inventateq.com/top-stories/wp-content/uploads/2024/05/bigdata2.png.webp" class="img-fluid"></p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p>In today‚Äôs world of ‚Äúbig data,‚Äù we‚Äôre often faced with testing hundreds or even thousands of hypotheses at once. This is called <strong>multiple testing</strong>. The main challenge is to avoid ‚Äúfalse positives‚Äù ‚Äî incorrectly rejecting a true null hypothesis. We want to make sure our ‚Äúdiscoveries‚Äù are real, not just random noise! üîç</p>
</div>
</div>
</div>
</section>
<section id="review-of-hypothesis-testing" class="level2">
<h2 class="anchored" data-anchor-id="review-of-hypothesis-testing">Review of Hypothesis Testing</h2>
<p>Hypothesis testing gives us a formal way to use data to answer specific questions. It provides a structured framework to evaluate evidence and make informed decisions.</p>
<ul>
<li><p><strong>Goal:</strong> Decide if there‚Äôs enough evidence to reject a pre-defined assumption (the null hypothesis).</p></li>
<li><p><strong>Examples:</strong></p>
<ul>
<li>In linear regression, is a specific coefficient significantly different from zero? This tells us if a predictor truly influences the outcome.</li>
<li>In a clinical trial, does a new drug actually lower blood pressure compared to a placebo?</li>
</ul></li>
</ul>
</section>
<section id="steps-in-hypothesis-testing" class="level2">
<h2 class="anchored" data-anchor-id="steps-in-hypothesis-testing">Steps in Hypothesis Testing</h2>
<p>We generally follow these steps:</p>
<ol type="1">
<li><strong>Define Hypotheses:</strong>
<ul>
<li><strong>Null Hypothesis (H‚ÇÄ):</strong> The default assumption ‚Äì usually representing ‚Äúno effect‚Äù or ‚Äúno difference.‚Äù</li>
<li><strong>Alternative Hypothesis (H‚Çê):</strong> What we suspect might be true if H‚ÇÄ isn‚Äôt.</li>
</ul></li>
<li><strong>Construct Test Statistic:</strong> Calculate a value that summarizes how strongly the data contradicts H‚ÇÄ.</li>
</ol>
</section>
<section id="steps-in-hypothesis-testing-continued" class="level2">
<h2 class="anchored" data-anchor-id="steps-in-hypothesis-testing-continued">Steps in Hypothesis Testing (Continued)</h2>
<ol start="3" type="1">
<li><p><strong>Compute p-value:</strong> Find the probability of seeing data as extreme (or more extreme) than what we observed, <em>assuming H‚ÇÄ is true</em>.</p></li>
<li><p><strong>Decide:</strong> Based on the p-value (and a pre-set threshold), decide whether to reject H‚ÇÄ.</p></li>
</ol>
</section>
<section id="defining-the-hypotheses" class="level2">
<h2 class="anchored" data-anchor-id="defining-the-hypotheses">Defining the Hypotheses</h2>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Null Hypothesis (H‚ÇÄ):</strong> The baseline assumption. We look for evidence <em>against</em> this. Think of it like the ‚Äústatus quo‚Äù or ‚Äúinnocent until proven guilty.‚Äù</p>
</div>
</div>
</div>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p><strong>Alternative Hypothesis (H‚Çê):</strong> What we think might be true if H‚ÇÄ is false. It‚Äôs often the opposite of H‚ÇÄ. For instance, if H‚ÇÄ is ‚ÄúA=B,‚Äù then H‚Çê is ‚ÄúA‚â†B.‚Äù</p>
</div>
</div>
</div>
</section>
<section id="constructing-the-test-statistic" class="level2">
<h2 class="anchored" data-anchor-id="constructing-the-test-statistic">Constructing the Test Statistic</h2>
<ul>
<li><p>The test statistic measures how far the data is from what we‚Äôd expect if H‚ÇÄ were true.</p></li>
<li><p>The exact formula depends on the specific hypothesis.</p></li>
<li><p><strong>Example:</strong> If we‚Äôre comparing the average values (means) of two groups (like treatment and control), we often use a <strong>two-sample t-statistic</strong>.</p></li>
</ul>
</section>
<section id="two-sample-t-statistic-formula" class="level2">
<h2 class="anchored" data-anchor-id="two-sample-t-statistic-formula">Two-Sample t-statistic: Formula</h2>
<p>The two-sample t-statistic is calculated like this:</p>
<p><span class="math display">\[
T = \frac{\hat{\mu}_t - \hat{\mu}_c}{s \sqrt{\frac{1}{n_t} + \frac{1}{n_c}}}
\]</span></p>
<p>where:</p>
<ul>
<li>$ _t, _c$: The <em>sample means</em> of the treatment and control groups. These are our best guesses for the true average values.</li>
<li>$ n_t, n_c $: The number of observations in each group.</li>
<li>$ s $: The ‚Äúpooled standard deviation‚Äù (explained next).</li>
</ul>
</section>
<section id="pooled-standard-deviation" class="level2">
<h2 class="anchored" data-anchor-id="pooled-standard-deviation">Pooled Standard Deviation</h2>
<p>The pooled standard deviation, <em>s</em>, combines the variability within each group:</p>
<p><span class="math display">\[ s = \sqrt{\frac{(n_t - 1)s_t^2 + (n_c - 1)s_c^2}{n_t + n_c - 2}} \]</span></p>
<ul>
<li><p><span class="math inline">\(s_t^2\)</span> and <span class="math inline">\(s_c^2\)</span> are the sample variances of the treatment and control groups. They measure how spread out the data is within each group.</p></li>
<li><p>A large absolute value of T (|T|) suggests that the group means are significantly different, providing evidence <em>against</em> the null hypothesis.</p></li>
</ul>
</section>
<section id="computing-the-p-value" class="level2">
<h2 class="anchored" data-anchor-id="computing-the-p-value">Computing the p-value</h2>
<ul>
<li><p><strong>p-value:</strong> The probability of observing a test statistic as extreme as (or more extreme than) the one we calculated, <em>if the null hypothesis were actually true</em>.</p></li>
<li><p>A small p-value means the data is unlikely under H‚ÇÄ, providing strong evidence <em>against</em> it.</p></li>
</ul>
</section>
<section id="p-value-important-clarification" class="level2">
<h2 class="anchored" data-anchor-id="p-value-important-clarification">p-value: Important Clarification</h2>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>The p-value is <strong>not</strong> the probability that H‚ÇÄ is true. It‚Äôs the probability of seeing the observed <em>data</em> (or more extreme data), <em>given that</em> H‚ÇÄ <em>is</em> true. This is a very important distinction! üßê</p>
</div>
</div>
</div>
</section>
<section id="example-p-value-interpretation" class="level2">
<h2 class="anchored" data-anchor-id="example-p-value-interpretation">Example: p-value Interpretation</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://axwslyfy9krb.objectstorage.ap-singapore-1.oci.customer-oci.com/n/axwslyfy9krb/b/qiufei/o/textbook%2Fisl_figures%2F6_7.svg" class="img-fluid figure-img"></p>
<figcaption>Density function for N(0,1)</figcaption>
</figure>
</div>
<p>This figure shows the probability density function of a standard normal distribution, often called a ‚Äúbell curve.‚Äù The vertical line marks a value of 2.33.</p>
</section>
<section id="example-p-value-interpretation-continued" class="level2">
<h2 class="anchored" data-anchor-id="example-p-value-interpretation-continued">Example: p-value Interpretation (Continued)</h2>
<ul>
<li>Only 1% of the area under the curve is to the right of 2.33.</li>
<li>This means there‚Äôs only a 2% chance of getting a value from this distribution that‚Äôs either greater than 2.33 or less than -2.33.</li>
<li>If our test statistic follows this distribution when H‚ÇÄ is true, and we observe a test statistic of T = 2.33, the p-value would be 0.02.</li>
</ul>
</section>
<section id="null-distribution" class="level2">
<h2 class="anchored" data-anchor-id="null-distribution">Null Distribution</h2>
<ul>
<li><p>The <strong>null distribution</strong> is the probability distribution of the test statistic <em>assuming the null hypothesis is true</em>. It tells us what values of the test statistic are likely (or unlikely) if there‚Äôs no real effect.</p></li>
<li><p>Common examples:</p>
<ul>
<li>Normal distribution (bell curve)</li>
<li>t-distribution (similar to normal, but used for smaller samples)</li>
<li>œá¬≤-distribution (Chi-squared distribution)</li>
<li>F-distribution</li>
</ul></li>
<li><p>We need to know the null distribution to calculate p-values.</p></li>
</ul>
</section>
<section id="decision-making" class="level2">
<h2 class="anchored" data-anchor-id="decision-making">Decision Making</h2>
<ul>
<li><p>We reject H‚ÇÄ if the p-value is smaller than a pre-defined ‚Äúsignificance level‚Äù (Œ±).</p></li>
<li><p><strong>Significance level (Œ±):</strong> The cutoff for rejecting H‚ÇÄ. A common choice is Œ± = 0.05 (5%).</p></li>
<li><p><strong>Decision Rule:</strong></p>
<ul>
<li>If p-value &lt; Œ±, we reject H‚ÇÄ.</li>
<li>If p-value ‚â• Œ±, we <em>fail to reject</em> H‚ÇÄ.</li>
</ul></li>
</ul>
</section>
<section id="decision-making-important-note" class="level2">
<h2 class="anchored" data-anchor-id="decision-making-important-note">Decision Making: Important Note</h2>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>We never ‚Äúaccept‚Äù H‚ÇÄ. We only ‚Äúreject‚Äù or ‚Äúfail to reject‚Äù it. Failing to reject doesn‚Äôt mean H‚ÇÄ is definitely true, just that we don‚Äôt have enough evidence to say it‚Äôs false.</p>
</div>
</div>
</div>
</section>
<section id="type-i-and-type-ii-errors-a-table" class="level2">
<h2 class="anchored" data-anchor-id="type-i-and-type-ii-errors-a-table">Type I and Type II Errors: A Table</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th></th>
<th>H‚ÇÄ True</th>
<th>H‚ÇÄ False</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Reject H‚ÇÄ</td>
<td>Type I Error</td>
<td>Correct Decision</td>
</tr>
<tr class="even">
<td>Fail to Reject H‚ÇÄ</td>
<td>Correct Decision</td>
<td>Type II Error</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>Type I error:</strong> Rejecting H‚ÇÄ when it‚Äôs actually true (a ‚Äúfalse positive‚Äù). The probability of this is Œ± (the significance level).</li>
<li><strong>Type II error:</strong> Failing to reject H‚ÇÄ when it‚Äôs actually false (a ‚Äúfalse negative‚Äù).</li>
</ul>
</section>
<section id="type-i-and-type-ii-errors-definitions" class="level2">
<h2 class="anchored" data-anchor-id="type-i-and-type-ii-errors-definitions">Type I and Type II Errors: Definitions</h2>
<ul>
<li><p><strong>Power:</strong> The probability of correctly rejecting H‚ÇÄ when it‚Äôs false (1 - Probability of Type II error). We want high power! üí™</p></li>
<li><p>Our goal is to control the chance of Type I errors (Œ±) while maximizing power (minimizing Type II errors).</p></li>
</ul>
</section>
<section id="the-challenge-of-multiple-testing" class="level2">
<h2 class="anchored" data-anchor-id="the-challenge-of-multiple-testing">The Challenge of Multiple Testing</h2>
<ul>
<li><p>When testing a <em>single</em> hypothesis, it‚Äôs relatively easy to control the Type I error rate (Œ±).</p></li>
<li><p><strong>Problem:</strong> When we test <em>many</em> hypotheses at the same time, the chance of making <em>at least one</em> Type I error goes way up, even if each individual test has a low Œ±.</p></li>
</ul>
</section>
<section id="multiple-testing-an-analogy" class="level2">
<h2 class="anchored" data-anchor-id="multiple-testing-an-analogy">Multiple Testing: An Analogy</h2>
<ul>
<li><p><strong>Analogy:</strong> Imagine flipping a fair coin many times. Each flip has a 50/50 chance, but if you flip enough times, you‚Äôre <em>bound</em> to see some ‚Äúunlikely‚Äù streaks (like all heads) just by random chance.</p></li>
<li><p>Similarly, when testing many hypotheses, some will look ‚Äúsignificant‚Äù (low p-value) just by chance, even if all the null hypotheses are true.</p></li>
</ul>
</section>
<section id="illustration-the-stockbroker" class="level2">
<h2 class="anchored" data-anchor-id="illustration-the-stockbroker">Illustration: The Stockbroker</h2>
<ul>
<li><p>A stockbroker claims they can predict whether Apple‚Äôs stock will go up or down for the next 10 days.</p></li>
<li><p>They email 1024 potential clients, each getting a different sequence of predictions (2¬π‚Å∞ = 1024 possible sequences).</p></li>
<li><p>Just by chance, one client will get a perfect prediction! They might think the stockbroker is amazing, but it‚Äôs just random luck.</p></li>
<li><p>This shows how making many ‚Äúguesses‚Äù (tests) can lead to seemingly significant results purely by chance.</p></li>
</ul>
</section>
<section id="family-wise-error-rate-fwer" class="level2">
<h2 class="anchored" data-anchor-id="family-wise-error-rate-fwer">Family-Wise Error Rate (FWER)</h2>
<ul>
<li><p><strong>FWER:</strong> The probability of making <em>at least one</em> Type I error (false positive) among <em>all</em> the hypothesis tests we do.</p></li>
<li><p>If all <em>m</em> tests are independent and all null hypotheses are true, then:</p></li>
</ul>
<p><span class="math display">\[ \text{FWER}(\alpha) = 1 - (1 - \alpha)^m \]</span></p>
<ul>
<li>This formula shows that the FWER increases quickly as <em>m</em> (the number of tests) increases.</li>
</ul>
</section>
<section id="fwer-example-visualized" class="level2">
<h2 class="anchored" data-anchor-id="fwer-example-visualized">FWER Example: Visualized</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://axwslyfy9krb.objectstorage.ap-singapore-1.oci.customer-oci.com/n/axwslyfy9krb/b/qiufei/o/textbook%2Fisl_figures%2F13_2.svg" class="img-fluid figure-img"></p>
<figcaption>FWER vs.&nbsp;Number of Hypotheses</figcaption>
</figure>
</div>
<p>This graph shows how the FWER changes as we test more hypotheses (the x-axis is on a log scale), for different values of Œ±.</p>
</section>
<section id="fwer-example-interpretation" class="level2">
<h2 class="anchored" data-anchor-id="fwer-example-interpretation">FWER Example: Interpretation</h2>
<ul>
<li><p>The dashed line is at 0.05.</p></li>
<li><p>To keep the FWER at 0.05 when testing 50 null hypotheses, we need to control the Type I error for <em>each individual hypothesis</em> at a much lower level (around Œ± = 0.001).</p></li>
<li><p>As we test more hypotheses, we need to be more and more strict with our individual significance levels to maintain the same overall FWER.</p></li>
</ul>
</section>
<section id="controlling-the-fwer" class="level2">
<h2 class="anchored" data-anchor-id="controlling-the-fwer">Controlling the FWER</h2>
<ul>
<li><p>To control the FWER at a specific level (Œ±), we need stricter rules for rejecting each hypothesis.</p></li>
<li><p>Common methods:</p>
<ul>
<li><strong>Bonferroni Correction:</strong> Very simple, but often too conservative.</li>
<li><strong>Holm‚Äôs Method:</strong> Less conservative than Bonferroni.</li>
</ul></li>
</ul>
</section>
<section id="bonferroni-correction" class="level2">
<h2 class="anchored" data-anchor-id="bonferroni-correction">Bonferroni Correction</h2>
<ul>
<li><p><strong>Rule:</strong> Reject H‚ÇÄj if its p-value is less than Œ±/m. Divide the desired overall significance level (Œ±) by the number of tests (m).</p></li>
<li><p><strong>Guarantee:</strong> FWER(Œ±/m) ‚â§ m √ó Œ±/m = Œ±. The Bonferroni correction ensures the FWER is no larger than Œ±.</p></li>
<li><p><strong>Advantages:</strong></p>
<ul>
<li>Easy to do.</li>
<li>Guaranteed FWER control.</li>
</ul></li>
<li><p><strong>Disadvantage:</strong></p>
<ul>
<li>Can be very conservative (low power), especially when <em>m</em> is large. We might miss real effects.</li>
</ul></li>
</ul>
</section>
<section id="holms-method" class="level2">
<h2 class="anchored" data-anchor-id="holms-method">Holm‚Äôs Method</h2>
<p>Holm‚Äôs method is a <em>step-down</em> procedure, which is less conservative than Bonferroni:</p>
<ol type="1">
<li><strong>Specify Œ±:</strong> Choose the desired overall FWER (e.g., Œ± = 0.05).</li>
<li><strong>Compute p-values:</strong> Calculate p-values (p1, ‚Ä¶, pm) for all <em>m</em> hypotheses.</li>
<li><strong>Order p-values:</strong> Sort the p-values from smallest to largest: p(1) ‚â§ p(2) ‚â§ ‚Ä¶ ‚â§ p(m).</li>
<li><strong>Find L:</strong> <span class="math display">\[ L = \min\big\{j:p_{(j)} &gt; \frac{\alpha}{m+1-j} \big\} \]</span></li>
</ol>
</section>
<section id="holms-method-continued" class="level2">
<h2 class="anchored" data-anchor-id="holms-method-continued">Holm‚Äôs Method (Continued)</h2>
<ol start="5" type="1">
<li><strong>Reject:</strong> Reject all null hypotheses H0j for which pj &lt; p(L).</li>
</ol>
<ul>
<li><strong>Advantages:</strong>
<ul>
<li>Controls the FWER.</li>
<li>Less conservative than Bonferroni (higher power). Holm will always reject at least as many hypotheses as Bonferroni, and usually more.</li>
</ul></li>
</ul>
</section>
<section id="holms-method-illustration" class="level2">
<h2 class="anchored" data-anchor-id="holms-method-illustration">Holm‚Äôs method illustration</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://axwslyfy9krb.objectstorage.ap-singapore-1.oci.customer-oci.com/n/axwslyfy9krb/b/qiufei/o/textbook%2Fisl_figures%2F13_3.svg" class="img-fluid figure-img"></p>
<figcaption>Holm‚Äôs and Bonferroni</figcaption>
</figure>
</div>
<p>Each panel shows sorted p-values from simulations with 10 hypotheses. Black dots are true null hypotheses (2 out of 10), and red dots are false null hypotheses.</p>
</section>
<section id="holms-method-illustration-continued" class="level2">
<h2 class="anchored" data-anchor-id="holms-method-illustration-continued">Holm‚Äôs method illustration (Continued)</h2>
<ul>
<li>The black line is the Bonferroni threshold (Œ±/m).</li>
<li>The blue line is the Holm threshold (Œ±/(m+1-j)).</li>
<li>The area between the lines shows hypotheses rejected by Holm but not Bonferroni.</li>
<li>Holm rejects more hypotheses, giving it higher power.</li>
</ul>
</section>
<section id="other-fwer-control-methods" class="level2">
<h2 class="anchored" data-anchor-id="other-fwer-control-methods">Other FWER Control Methods</h2>
<ul>
<li><p><strong>Tukey‚Äôs Method:</strong> Specifically for comparing all possible pairs of group means in ANOVA (Analysis of Variance).</p></li>
<li><p><strong>Scheff√©‚Äôs Method:</strong> Allows testing <em>any</em> linear combination of group means, even after seeing the data. Very flexible, but also very conservative.</p></li>
<li><p>These are more powerful than Bonferroni/Holm in their specific situations, but less general.</p></li>
</ul>
</section>
<section id="trade-off-fwer-and-power" class="level2">
<h2 class="anchored" data-anchor-id="trade-off-fwer-and-power">Trade-Off: FWER and Power</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://axwslyfy9krb.objectstorage.ap-singapore-1.oci.customer-oci.com/n/axwslyfy9krb/b/qiufei/o/textbook%2Fisl_figures%2F13_5.svg" class="img-fluid figure-img"></p>
<figcaption>FWER and Power</figcaption>
</figure>
</div>
<p>This plot shows how FWER and power are related in a simulation where 90% of the null hypotheses are true.</p>
</section>
<section id="trade-off-fwer-and-power-continued" class="level2">
<h2 class="anchored" data-anchor-id="trade-off-fwer-and-power-continued">Trade-Off: FWER and Power (Continued)</h2>
<ul>
<li><p>As <em>m</em> (number of hypotheses) increases, power goes down for a fixed FWER.</p></li>
<li><p>Controlling the FWER very strictly (low Œ±) means lower power (more Type II errors). We‚Äôre less likely to find true effects.</p></li>
<li><p>The dashed vertical line is at FWER = 0.05.</p></li>
<li><p>This shows the key trade-off: being more conservative (controlling FWER) reduces our ability to find real effects.</p></li>
</ul>
</section>
<section id="false-discovery-rate-fdr" class="level2">
<h2 class="anchored" data-anchor-id="false-discovery-rate-fdr">False Discovery Rate (FDR)</h2>
<ul>
<li><strong>FDR:</strong> The expected proportion of <em>false positives</em> (Type I errors) among all the <em>rejected</em> null hypotheses.</li>
</ul>
<p><span class="math display">\[ \text{FDR} = E\left(\frac{\text{Number of Type I Errors}}{\text{Number of Rejected Hypotheses}}\right) = E\left(\frac{V}{R}\right) \]</span></p>
<ul>
<li><p>Where V is the number of Type I Errors and R is the number of Rejected Hypotheses.</p></li>
<li><p>Controlling the FDR is <em>less strict</em> than controlling the FWER. It allows for <em>some</em> false positives, but aims to keep their proportion low.</p></li>
</ul>
</section>
<section id="fdr-motivation" class="level2">
<h2 class="anchored" data-anchor-id="fdr-motivation">FDR: Motivation</h2>
<ul>
<li><p><strong>Motivation:</strong> In exploratory studies with many hypotheses (<em>m</em>), we might be okay with <em>some</em> false positives to discover more true effects. We‚Äôre prioritizing discovery over absolute certainty.</p></li>
<li><p>FDR control is good when we‚Äôre more interested in finding potential leads than in making rock-solid claims.</p></li>
</ul>
</section>
<section id="benjamini-hochberg-bh-procedure" class="level2">
<h2 class="anchored" data-anchor-id="benjamini-hochberg-bh-procedure">Benjamini-Hochberg (BH) Procedure</h2>
<p>The Benjamini-Hochberg (BH) procedure is a popular way to control the FDR at a desired level, <em>q</em>:</p>
<ol type="1">
<li><strong>Specify <em>q</em>:</strong> Choose the desired FDR level (e.g., <em>q</em> = 0.10).</li>
<li><strong>Compute p-values:</strong> Get p-values (p1, ‚Ä¶, pm) for all <em>m</em> hypotheses.</li>
<li><strong>Order p-values:</strong> Sort them from smallest to largest: p(1) ‚â§ p(2) ‚â§ ‚Ä¶ ‚â§ p(m).</li>
<li><strong>Find L:</strong> <span class="math display">\[L = \max\{j : p_{(j)} \leq qj/m\}.\]</span></li>
<li><strong>Reject:</strong> Reject all null hypotheses H0j for which pj ‚â§ p(L).</li>
</ol>
</section>
<section id="benjamini-hochberg-bh-procedure-continued" class="level2">
<h2 class="anchored" data-anchor-id="benjamini-hochberg-bh-procedure-continued">Benjamini-Hochberg (BH) Procedure (Continued)</h2>
<ul>
<li><p><strong>Guarantee:</strong> The BH procedure guarantees that FDR ‚â§ <em>q</em> if the p-values are independent (or have some types of mild dependence).</p></li>
<li><p><strong>Key Idea:</strong> The cutoff for rejecting a hypothesis depends on <em>all</em> the p-values (through <em>L</em>), not just its own. This adaptive cutoff makes it less conservative than Bonferroni or Holm.</p></li>
</ul>
</section>
<section id="example-bh-and-bonferroni" class="level2">
<h2 class="anchored" data-anchor-id="example-bh-and-bonferroni">Example: BH and Bonferroni</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://axwslyfy9krb.objectstorage.ap-singapore-1.oci.customer-oci.com/n/axwslyfy9krb/b/qiufei/o/textbook%2Fisl_figures%2F13_6.svg" class="img-fluid figure-img"></p>
<figcaption>BH and Bonferroni</figcaption>
</figure>
</div>
<p>This figure shows the same set of 2000 ordered p-values, comparing Bonferroni (FWER control) and BH (FDR control) thresholds.</p>
</section>
<section id="example-bh-and-bonferroni-continued" class="level2">
<h2 class="anchored" data-anchor-id="example-bh-and-bonferroni-continued">Example: BH and Bonferroni (Continued)</h2>
<ul>
<li>Green lines are Bonferroni thresholds for different Œ± levels.</li>
<li>Orange lines are BH thresholds for different <em>q</em> levels.</li>
<li>Blue dots show p-values of rejected null hypotheses under BH.</li>
<li>BH rejects many more hypotheses than Bonferroni for the same level of error control (e.g., compare Œ±=0.1 and q=0.1). This shows the increased power of FDR control.</li>
</ul>
</section>
<section id="re-sampling-approaches" class="level2">
<h2 class="anchored" data-anchor-id="re-sampling-approaches">Re-Sampling Approaches</h2>
<ul>
<li><p>So far, we‚Äôve assumed we know the <em>theoretical null distribution</em> of the test statistic (like the t-distribution or F-distribution).</p></li>
<li><p><strong>Problem:</strong> Sometimes, the theoretical null distribution is unknown, or the assumptions needed for it to be valid aren‚Äôt met (e.g., data isn‚Äôt normally distributed, small sample size).</p></li>
<li><p><strong>Solution:</strong> Use <em>re-sampling</em> methods (like permutation tests) to <em>estimate</em> the null distribution from the data itself.</p></li>
</ul>
</section>
<section id="permutation-test-example" class="level2">
<h2 class="anchored" data-anchor-id="permutation-test-example">Permutation Test: Example</h2>
<ul>
<li><p>Suppose we want to compare the average values of two groups (X and Y).</p></li>
<li><p><strong>Null Hypothesis (H‚ÇÄ):</strong> The distributions of X and Y are the same. This means the group labels (‚ÄúX‚Äù or ‚ÄúY‚Äù) are essentially random.</p></li>
<li><p><strong>Idea:</strong> If H‚ÇÄ is true, then randomly swapping observations between the groups shouldn‚Äôt systematically change the test statistic.</p></li>
<li><p>We can <em>permute</em> (shuffle) the data many times, calculate the test statistic each time, and build an empirical null distribution.</p></li>
</ul>
</section>
<section id="permutation-test-steps" class="level2">
<h2 class="anchored" data-anchor-id="permutation-test-steps">Permutation Test: Steps</h2>
<ol type="1">
<li><p><strong>Calculate the test statistic:</strong> Compute the test statistic (e.g., the t-statistic) on the <em>original</em> data.</p></li>
<li><p><strong>Repeat many times:</strong></p>
<ul>
<li>Randomly shuffle the observations between the two groups.</li>
<li>Calculate the test statistic on the <em>shuffled</em> data.</li>
</ul></li>
<li><p><strong>Calculate the p-value:</strong> The p-value is the proportion of shuffled test statistics that are as extreme as (or more extreme than) the original test statistic.</p></li>
</ol>
</section>
<section id="resampling-for-fdr-control" class="level2">
<h2 class="anchored" data-anchor-id="resampling-for-fdr-control">Resampling for FDR Control</h2>
<ul>
<li><p>We can also use re-sampling to estimate the FDR directly, without calculating p-values first.</p></li>
<li><p>The idea is to approximate:</p>
<ul>
<li>E(V): The expected number of false positives. We estimate this by shuffling the data (simulating the null hypothesis) and counting how many hypotheses we‚Äôd reject.</li>
<li>R: The total number of rejections on the <em>original</em> data.</li>
</ul></li>
</ul>
<p><span class="math display">\[FDR = E(\frac{V}{R}) \approx \frac{E(V)}{R} \]</span></p>
<ul>
<li>Using re-sampling to estimate the null distribution can combine information across multiple hypotheses.</li>
</ul>
</section>
<section id="when-is-re-sampling-useful" class="level2">
<h2 class="anchored" data-anchor-id="when-is-re-sampling-useful">When is Re-Sampling Useful?</h2>
<ul>
<li>When the theoretical null distribution is unknown or unreliable.</li>
<li>When assumptions for the theoretical distribution are violated (e.g., data isn‚Äôt normally distributed, sample size is small).</li>
<li>Provides a flexible way to do hypothesis testing in complex situations where standard theoretical results don‚Äôt apply.</li>
</ul>
</section>
<section id="re-sampling-example-comparison-with-theoretical-null" class="level2">
<h2 class="anchored" data-anchor-id="re-sampling-example-comparison-with-theoretical-null">Re-Sampling Example: Comparison with Theoretical Null</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://axwslyfy9krb.objectstorage.ap-singapore-1.oci.customer-oci.com/n/axwslyfy9krb/b/qiufei/o/textbook%2Fisl_figures%2F13_7.svg" class="img-fluid figure-img"></p>
<figcaption>Theoretical and resampling null distribution comparison</figcaption>
</figure>
</div>
<p>This shows the theoretical and re-sampling null distributions for the 11th gene in the Khan dataset. They‚Äôre very similar. The theoretical p-value is 0.041, and the re-sampling p-value is 0.042.</p>
</section>
<section id="re-sampling-example-different-distributions" class="level2">
<h2 class="anchored" data-anchor-id="re-sampling-example-different-distributions">Re-Sampling Example: Different Distributions</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://axwslyfy9krb.objectstorage.ap-singapore-1.oci.customer-oci.com/n/axwslyfy9krb/b/qiufei/o/textbook%2Fisl_figures%2F13_8.svg" class="img-fluid figure-img"></p>
<figcaption>Theoretical and resampling null distribution comparison</figcaption>
</figure>
</div>
<p>This shows the theoretical and re-sampling null distributions for the 877th gene in the Khan dataset. They‚Äôre quite <em>different</em>. The theoretical p-value is 0.571, and the re-sampling p-value is 0.673. This shows how re-sampling can be more accurate when the theoretical distribution isn‚Äôt a good fit.</p>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<ul>
<li><p><strong>Multiple testing:</strong> Testing many hypotheses at once increases the risk of false positives (Type I errors).</p></li>
<li><p><strong>FWER control:</strong> Strict methods like Bonferroni and Holm control the chance of <em>any</em> false positives, but can have low power.</p></li>
<li><p><strong>FDR control:</strong> Less strict, allowing some false positives to increase discovery. The Benjamini-Hochberg (BH) procedure is a common method.</p></li>
<li><p><strong>Re-sampling:</strong> A flexible way to estimate null distributions and do inference when theoretical assumptions are violated or the null distribution is unknown.</p></li>
</ul>
</section>
<section id="thoughts-for-discussion" class="level2">
<h2 class="anchored" data-anchor-id="thoughts-for-discussion">Thoughts for Discussion ü§î</h2>
<ul>
<li><p>How do you choose between controlling the FWER and the FDR in practice? What factors affect your decision?</p></li>
<li><p>What are the trade-offs in choosing a stricter (FWER) versus a more lenient (FDR) approach?</p></li>
<li><p>Can you think of real-world situations where multiple testing is important (e.g., genomics, A/B testing, finance)?</p></li>
<li><p>When would you prefer to use a re-sampling approach (like a permutation test) instead of a theoretical null distribution?</p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/qiufei\.github\.io\/web-slide-r");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>üîã<a href="https://posit.co"><img src="https://posit.co/wp-content/themes/Posit/assets/images/posit-logo-2024.png" class="img-fluid" alt="Posit" width="65"></a></p>
</div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 ÈÇ±È£û ¬© 2025
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://beian.miit.gov.cn">
<p>ÊµôICPÂ§á 2024072710Âè∑-1</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="http://www.beian.gov.cn/portal/registerSystemInfo?recordcode=33021202002511">
<p>ÊµôÂÖ¨ÁΩëÂÆâÂ§á 33021202002511Âè∑</p>
</a>
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="mailto:hfutqiufei@163.com">
      <i class="bi bi-envelope-at-fill" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>